\subsection{Exercise Set 2}\label{subsec:exercise-set-2}
\begin{exercise}{1}
    Prove that the following languages are not regular:
    \begin{enumerate}[(a)]
        \item \(L=\{x\in{(0\cup1)}^*2{(0\cup1)}^*|\text{number of 0s before 2} = \text{number of 1s after 2}\} \)
        \item \(L=\{x\in{(0\cup1)}^*2{(0\cup1)}^*|\text{number of 0s before 2} \neq \text{number of 1s after 2}\} \)
        \item \(L=\{a^{i^2}|i\geq1\} \)
        \item \(L=\{a^{2^i}|i\geq1\} \)
    \end{enumerate}
\end{exercise}
\begin{solution}\mbox{\\}
\begin{enumerate}[(a)]
    \item Suppose, by way of contradiction, that \(L\) is regular and that \(p\) is its pumping length. Consider the string \(s=0^p21^p\). Clearly, \(|s|\geq p\). Thus, by the \textbf{Pumping Lemma}, there exist strings \(s_1, s_2, s_3\) such that \(s=s_1s_2s_3\) with \(|s_1s_2|\leq p\) and \(|s_2|\geq1\) and, for all \(n\geq 0\), \(s_1s_2^n s_3\in L\). Observe that \(s_1s_2=0^k\) for some \(k\leq p\) (for otherwise \(|s_1s_2| > p\)), hence \(s_3=0^{p-k}21^p\). Thus, we write \(s_1=0^{k-q}\) and \(s_2=0^{q}\) for some \(q\geq1\). By the pumping lemma, 
    \begin{align*}
        s_1s_2^n s_3 &= 0^{k-q}{(0^q)}^n0^{p-k}21^p\\
                    &= 0^{k-q}0^{qn}0^{p-k}21^p\\
                    &= 0^{p+q(n-1)}21^p
    \end{align*}

    is in \(L\). However, for \(n\geq2\), there are more 0s before the 2 than 1s after, hence \(s_1s_2^n s_3\not\in L\). A contradiction. Thus, \(L\) is not regular.

    \item Suppose, by way of contradiction, that \(L\) is regular and that \(p\) is its pumping length. Consider the string \(s=0^p21^{p+p!}\). Clearly, \(|s|\geq p\). Thus, by the \textbf{Pumping Lemma}, there exist strings \(s_1\), \(s_2\), \(s_3\) such that \(s=s_1s_2s_3\) with \(|s_1s_2|\leq p\) and \(|s_2|\geq1\) and, for all \(n\geq 0\), \(s_1s_2^n s_3\in L\). Observe that \(s_1s_2=0^k\) for some \(k\leq p\) (for otherwise \(|s_1s_2| > p\)), hence \(s_3=0^{p-k}21^{p+p!}\). Thus, we write \(s_1=0^{k-q}\) and \(s_2=0^{q}\) for some \(q\geq1\). By the pumping lemma, 
    \begin{align*}
        s_1s_2^n s_3 &= 0^{k-q}{(0^q)}^n0^{p-k}21^{p+p!}\\
                    &= 0^{k-q}0^{qn}0^{p-k}21^{p+p!}\\
                    &= 0^{p+q(n-1)}21^{p+p!}
    \end{align*}

    is in \(L\). Now, since \(q\leq p\), \(q\mid p{!}\). Thus, taking \(n=\frac{p!}{q}+1\), we have 
    \begin{align*}
        s_1s_2^n s_3 &= 0^{p+q(\frac{p!}{q}+1-1)}21^{p+p!}\\
                    &= 0^{p+q(\frac{p!}{q})}21^{p+p!}\\
                    &= 0^{p+p!}21^{p+p!}
    \end{align*}
    
    Thus, \(s_1s_2^n s_3\not\in L\), a contradiction. Therefore \(L\) is not regular.
    \item In order to reach a contradiction, suppose \(L\) is regular and that \(p\) is its pumping length. Consider the string \(s=a^{p^2}\). By the pumping lemma, we have \(s=s_1s_2s_3\). Since \(|s_1s_2|\leq p\), this forces \(s_1s_2=a^k\) for some \(0<k\leq p\) and \(s_3=a^{p^2-k}\). Then \(s_1=a^{k-r}\) and \(s_2=a^r\) for some \(0<r\leq k\). Then
    \begin{align*}
        s_1s_2^n s_3 &= a^{k-r}{(a^r)}^n a^{p^2-k}\\
                    &= a^{k-r}a^{rn}a^{p^2-k}\\
                    &= a^{p^2+rn-r}\\
                    &= a^{p^2+r(n-1)}
    \end{align*}
    Take \(n=2\). Then \(s_1s_2^n s_3=a^{p^2+r}\in L\). However, \(p^2+r\) cannot be a perfect square: since \(r \leq p\), we have 
    \begin{align*}
        p^2+r &\leq p^2 + p\\
              &< p^2 + p + 1\\
              &= {(p+1)}^2
    \end{align*}
    
    Thus, \(s_1s_2^n s_3\not\in L\), a contradiction. Therefore \(L\) is not regular.
    \item In order to reach a contradiction, suppose \(L\) is regular and that \(p\) is its pumping length. Consider the string \(s=a^{2^p}\). By the pumping lemma, we have \(s=s_1s_2s_3\). Since \(|s_1s_2|\leq p\), this forces \(s_1s_2=a^k\) for some \(0<k\leq p\) and \(s_3=a^{2^p-k}\). Then \(s_1=a^{k-r}\) and \(s_2=a^r\) for some \(0<r\leq k\). Then
    \begin{align*}
        s_1s_2^n s_3 &= a^{k-r}{(a^r)}^n a^{2^p-k}\\
                    &= a^{k-r}a^{rn}a^{2^p-k}\\
                    &= a^{2^p+rn-r}\\
                    &= a^{2^p+r(n-1)}
    \end{align*}
    Take \(n=2\). Then \(s_1s_2^n s_3=a^{2^p+r}\in L\). However, \(2^p+r\) cannot be a power of 2: since \(r \leq p\), we have 
    \begin{align*}
        2^p+r &\leq 2^p + p\\
              &< 2^p + 2^p\\
              &= 2^{p+1}
    \end{align*}
    
    Thus, \(s_1s_2^n s_3\not\in L\), a contradiction. Therefore \(L\) is not regular.
\end{enumerate}
    
\end{solution}

\begin{exercise}{2}
    Construct DFAs for the following extended regular expressions:
    \begin{enumerate}[(a)]
        \item \(\left[\overline{{(000)}^*}\cap\left({(01)}^*\cup{(10)}^*\right)\right]\cap\overline{{(11)}^*}\) over \( \{0,1\} \)
        \item \(\overline{{(0\cup1)}^*01^*10^*01^*1{(0\cup1)}^*} - {(10\cup01)}^*\) over \( \{0, 1, 2\} \)
    \end{enumerate}
\end{exercise}

\begin{exercise}{3}
    Construct Chomsky Normal Form grammars for \(L(G)-\varepsilon \) for the following cfgs \(G\):
    \begin{enumerate}[(a)]
        \item \(G=\left(\{a, b\}, \{S, A\}, S, \{S\to aAAaS\mid a, A\to bAA\mid aSSSA\mid \varepsilon \}\right)\)
        \item \(G=\left(\{a, b, c\}, \{S, A, B\}, S, \{S\to aAA\mid A, A\to bBBB\mid B\mid \varepsilon, B\to bSSS\mid S\mid \varepsilon \}\right)\)
    \end{enumerate}
\end{exercise}

\begin{solution}\mbox{\\}
    \begin{enumerate}[(a)]
        \item 
        \begin{align*}
            S &\to aAAaS\mid a\\
            A &\to bAA\mid aSSSA\mid \varepsilon 
        \end{align*}

        There are no useless productions, since \(S\Rightarrow a\) and \(A\Rightarrow b\). \(A\) is clearly nullable, so we get  

        \begin{align*}
            S &\to aAAaS\mid a{\color{red}\cancel{A}}AaS\mid aA{\color{red}\cancel{A}}aS\mid a{\color{red}\cancel{A}}{\color{red}\cancel{A}}aS\mid a\\
            A &\to bAA\mid b{\color{red}\cancel{A}}A\mid bA{\color{red}\cancel{A}}\mid b{\color{red}\cancel{A}}{\color{red}\cancel{A}} \mid aSSSA\mid aSSS{\color{red}\cancel{A}} 
        \end{align*}

        which reduces to 

        \begin{align*}
            S &\to aAAaS\mid aAaS\mid aaS\mid a\\
            A &\to bAA\mid bA\mid b \mid aSSSA\mid aSSS 
        \end{align*}
        There are no unit productions. Setting \(X_a\to a\) and \(X_b\to b\), we have 

        \begin{align*}
            S &\to X_a AAX_a S\mid X_a AX_a S\mid X_a X_a S\mid a\\
            A &\to X_b AA\mid X_b A\mid b \mid X_a SSSA\mid X_a SSS 
        \end{align*}

        Finally, we decompose:

        \begin{align*}
            S &\to X_a S_1\mid X_a S_2\mid X_a S_3\mid a\\
            A &\to X_b A_1\mid X_b A\mid b \mid X_a A_2\mid X_a A_5 \\
            S_1 &\to AS_2\\
            S_2 &\to AS_3\\
            S_3 &\to X_a S\\
            A_1 &\to AA\\
            A_2 &\to SA_3\\
            A_3 &\to SA_4\\
            A_4 &\to SA\\
            A_5 &\to SA_6\\
            A_6 &\to SS
        \end{align*}

        \item 
        \begin{align*}
            S &\to aAA\mid A\\ 
            A &\to bBBB\mid B\mid \varepsilon \\
            B &\to bSSS\mid S\mid \varepsilon 
        \end{align*}

        There are no useless productions, since \(S\Rightarrow a\), \(A\Rightarrow b\) and \(B\Rightarrow b\). Clearly, \(S\), \(A\), and \(B\) are all nullable. Thus, we have 

        \begin{align*}
            S &\to aAA\mid a{\color{red}\cancel{A}}\mid aA{\color{red}\cancel{A}}\mid a{\color{red}\cancel{A}}{\color{red}\cancel{A}}\mid A\mid {\color{red}\cancel{A}}\\ 
            A &\to bBBB\mid b{\color{red}\cancel{B}}BB\mid bB{\color{red}\cancel{B}}B\mid bBB{\color{red}\cancel{B}}\mid b{\color{red}\cancel{B}}{\color{red}\cancel{B}}B\mid b{\color{red}\cancel{B}}B{\color{red}\cancel{B}}\mid bB{\color{red}\cancel{B}}{\color{red}\cancel{B}}\mid B\mid {\color{red}\cancel{B}}\\
            B &\to bSSS\mid b{\color{red}\cancel{S}}SS\mid bS{\color{red}\cancel{S}}S\mid bSS{\color{red}\cancel{S}}\mid b{\color{red}\cancel{S}}{\color{red}\cancel{S}}S\mid b{\color{red}\cancel{S}}S{\color{red}\cancel{S}}\mid bS{\color{red}\cancel{S}}{\color{red}\cancel{S}}\mid b{\color{red}\cancel{S}}{\color{red}\cancel{S}}{\color{red}\cancel{S}}\mid S\mid {\color{red}\cancel{S}} 
        \end{align*}

        which reduces to

        \begin{align*}
            S &\to aAA\mid a\mid aA\mid A \\ 
            A &\to bBBB\mid bBB\mid bB\mid B \\
            B &\to bSSS\mid bSS\mid bS\mid b\mid S  
        \end{align*}

        We eliminate the unit productions \(S\to A\), \(A\to B\) and \(B\to S\).

        \begin{align*}
            S &\to aAA\mid a\mid aA\mid bBBB\mid bBB\mid bB \\ 
            A &\to bBBB\mid bBB\mid bB\mid bSSS\mid bSS\mid bS\mid b \\
            B &\to bSSS\mid bSS\mid bS\mid b\mid aAA\mid a\mid aA\mid bBBB\mid bBB\mid bB
        \end{align*}

        We now set \(X_a\to a\) and \(X_b\to b\):

        \begin{align*}
            S &\to X_a AA\mid a\mid X_a A\mid X_b BBB\mid X_b BB\mid X_b B \\ 
            A &\to X_b BBB\mid X_b BB\mid X_b B\mid X_b SSS\mid X_b SS\mid X_b S\mid b \\
            B &\to X_b SSS\mid X_b SS\mid X_b S\mid b\mid X_a AA\mid a\mid X_a A\mid X_b BBB\mid X_b BB\mid X_b B
        \end{align*}

        Finally, we decompose:

        \begin{align*}
            S &\to X_a S_1\mid a\mid X_a A\mid X_b S_2\mid X_b S_3\mid X_b B \\ 
            A &\to X_b S_2\mid X_b S_3\mid X_b B\mid X_b A_1\mid X_b A_2\mid X_b S\mid b \\
            B &\to X_b A_1\mid X_b A_2\mid X_b S\mid b\mid X_a S_1\mid a\mid X_a A\mid X_b S_2\mid X_b S_3\mid X_b B\\
            S_1 &\to AA\\
            S_2 &\to BS_3\\
            S_3 &\to BB\\
            A_1 &\to SA_2\\
            A_2 &\to SS\\
        \end{align*}
    \end{enumerate}
\end{solution}

\begin{exercise}{4}
    Construct Greibach Normal Form grammars for \(L(G)-\varepsilon \) for the following cfgs \(G\):
    \begin{enumerate}[(a)]
        \item \(G=\left(\{a, b\}, \{S, A, B\}, S, \{S\to SaS\mid A, A\to AAAb\mid B\mid \varepsilon, B\to SSS\mid a \}\right)\)
        \item \(G=\left(\{a, b\}, \{S, A, B, C\}, S, \{S\to ASS\mid a, A\to bBBB\mid BAA\mid \varepsilon, B\to CSS\mid SSC, C\to SS\mid b\}\right)\)
    \end{enumerate}
\end{exercise}

\begin{solution}\mbox{\\}
    \begin{enumerate}[(a)]
        \item 
        \begin{align*}
            S &\to SaS\mid A\\
            A &\to AAAb\mid B\mid \varepsilon \\
            B &\to SSS\mid a
        \end{align*}
        There are no useless productions, since \(B\Rightarrow a\), \(A\Rightarrow b\), and \(S\Rightarrow b\). We eliminate \(\varepsilon \) productions:
        
        \begin{align*}
            S &\to SaS\mid A\mid {\color{red}\cancel{A}}\\
            A &\to AAAb\mid {\color{red}\cancel{A}}AAb\mid A{\color{red}\cancel{A}}Ab\mid AA{\color{red}\cancel{A}}b\mid {\color{red}\cancel{A}}{\color{red}\cancel{A}}Ab\mid {\color{red}\cancel{A}}A{\color{red}\cancel{A}}b\mid A{\color{red}\cancel{A}}{\color{red}\cancel{A}}b\mid {\color{red}\cancel{A}}{\color{red}\cancel{A}}{\color{red}\cancel{A}}b\mid B \\
            B &\to SSS\mid a
        \end{align*}

        which reduces to

        \begin{align*}
            S &\to SaS\mid A\\
            A &\to AAAb\mid AAb\mid Ab\mid b\mid B \\
            B &\to SSS\mid a
        \end{align*}
        
        We now remove the unit productions, \(S\to A\) and \(A\to B\):

        \begin{align*}
            S &\to SaS\mid AAAb\mid AAb\mid Ab\mid b\\
            A &\to AAAb\mid AAb\mid Ab\mid b\mid SSS\mid a \\
            B &\to SSS\mid a
        \end{align*}
        
        \item 
        \begin{align*}
            S &\to ASS\mid a\\
            A &\to bBBB\mid BAA\mid \varepsilon \\
            B &\to CSS\mid SSC\\
            C &\to SS\mid b
        \end{align*}
    \end{enumerate}
\end{solution}